## Операции с дисками виртуальных машин в среде Ред Виртуализация

Перед началом работы со скриптом необходимо в скрипте задать переменные для подключения к API ВМ Engine:
* OVIRT_USER - имя пользователя ВМ Engine с правами администратора в формате 'admin@internal'
* OVIRT_PASS - пароль пользвателя ВМ Engine с правами администратора
* OVIRT_URL - адрес API Engine в виде "https://<hosted-engine>/ovirt-engine/api" где <hosted-engine> - FQDN менеджера виртуализации

Скрипт обеспечивает поддержку базовых операций с дисками виртуальных машин:  
* Массовое создание дисков ВМ.  
* Массовое удаление дисков ВМ.  
* Массовое перемещение дисков ВМ между доменами хранения.  

Скрипт запускается из командной строки без аргументов. Работает в интерактивном режиме:
- После запуска скрипта выбрать режим работы. а - добавление дисков ВМ, d - удаление, m - перемещение.  
- При выборе режима создания дисков 'a':  
    - Будет предложено выбрать номер домена хранения, в котором будут созданы новые диски ВМ.    
    - Далее нужно ввести часть названия ВМ для которых необходимо создать диски или указать символ '*' для вывода всех ВМ, существующих в системе.  
    - Выбрать через пробел номера найденных ВМ или указать символ '*' для выбора всех наденных ВМ.  
    - Указать требуемый размер диска в ГБ.  
    - Выбрать 't' для создания тонких дисков или 'r' для создания толстых.  
    - Указать требуемое количество дисков.  
    - Имена (псевдонимы) вновь создаваемых дисков задаются автоматически и состоят из названия ВМ и порядкового номера диска. Например, для ВМ с именем 'test' будут созданы диски 'test_1', 'test_2' и т.д. При этом если у ВМ уже есть несколько дисков с именами в данном формате, то нумерация вновь создаваемых дисков будет продолжена. Например, если диски 'test_1', 'test_2' уже существуют, то будут созданы новые диски с именами 'test_3', 'test_4' и т.д. Аналогичные имена добавляются в описание создаваемых дисков.  
- При выборе режима удаления дисков 'd':  
    - Указать режим поиска дисков:  
        - 'v' - по имени ВМ. Нужно указать имя конкретной ВМ или часть имени для поиска нескольких ВМ. После этого указать номера ВМ через пробел (или символ '*' для всех найденных ВМ) для вывода дисков, принадлежащих данным ВМ.  
        - 'd' - по имени дисков. Нужно указать имя конкретного диска или часть имени для поиска нескольких дисков.
    - Выбрать номера дисков через пробел или указать символ '*' для выбора всех дисков.  
- При выборе режима перемещения дисков 'm':  
    - Указать режим поиска дисков:  
        - 'v' - по имени ВМ. Нужно указать имя конкретной ВМ или часть имени для поиска нескольких ВМ. После этого указать номера ВМ (или символ '*' для всех найденных ВМ) для вывода дисков, принадлежащих данным ВМ.  
        - 'd' - по имени дисков. Нужно указать имя конкретного диска или часть имени для поиска нескольких дисков.
    - Указать номера дисков через пробел или символ '*' для выбора всех дисков.  
    - Далее выводится список существующих в системе доменов хранения. Необходимо выбрать номер домена, в который будет перемещены выбранные диски.  

Работоспособность скрипта протестирована с версией "Ред Виртуализация 7.3" (oVirt 4.4)  

---
    